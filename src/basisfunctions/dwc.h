#ifndef DWC_H
#define DWC_H

class DWC {
   private:
       static constexpr double m_epsDW2D[21] = {
                   0.8098899984127201,
                   1.2344116951250368,
                   1.8098899984127201,
                   2.0042031506581126,
                   2.236534553021039,
                   2.703726103430899,
                   2.8112982274735496,
                   3.004203150658114,
                   3.2365345530210368,
                   3.8071034640383425,
                   3.811298227473549,
                   3.942517529240188,
                   4.214038230109308,
                   4.371620832904485,
                   4.625203345401196,
                   4.807103464038344,
                   4.935810416452243,
                   4.942517529240186,
                   5.214038230109309,
                   5.371620832904489,
                   5.935810416452244
             };
       static constexpr double m_C2D[441] = {
               0.9513938862695102, 5.030939328105808e-16, 1.7836177858996465e-16, 0.2963758312507054, 0.0, -8.514873062092622e-17, 0.0, 0.0, 0.0, -0.08373195220136542, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.386503261601332e-52, 
               -5.551115123125783e-17, 4.942911392669149e-16, 0.9513938862695098, -4.440892098500626e-16, -4.581801463353519e-16, 3.107923385917407e-16, 1.517494629328171e-16, 0.29637583125070666, -1.2514044023993472e-16, 1.1102230246251565e-16, -2.682678141737328e-16, -6.155265710878427e-18, 8.000008346030675e-17, -2.07241847468989e-32, 6.164279871911087e-16, -0.08373195220136569, 7.76985352798807e-30, -9.058317437762748e-17, -1.0463614917005657e-17, -8.641655931961978e-32, -4.221919953864804e-32, 
               -2.914335439641036e-16, 0.9563752334786217, -7.293145060530989e-16, -7.771561172376096e-16, -3.1478308916576223e-16, 0.2814265808284497, 2.7491764885548556e-16, 4.0245584642661925e-16, -2.870365584604295e-17, -3.3306690738754696e-16, 3.926870157740164e-18, 2.2169517768840294e-18, 2.3094034860500337e-17, -5.9825568211788144e-33, -0.07839319097932064, -2.9772060063766667e-16, 5.495015593702014e-31, -1.5066943613198256e-17, 1.660750249219465e-17, -4.098768903371932e-33, -9.620330380675916e-34, 
               4.930380657631324e-32, -1.1102230246251565e-16, -3.608224830031759e-16, 4.930380657631324e-31, 3.812053106271963e-16, -2.220446049250313e-16, 0.9545870548474231, 6.418476861114186e-16, 3.2889797147220954e-15, -9.860761315262648e-32, 7.752542026606892e-16, 1.3176513034137898e-15, 0.29793213105961375, 6.612269606281489e-17, 1.3877787807814457e-16, 1.942890293094024e-16, -2.626765417335012e-16, -9.896362398909924e-16, -3.612174210324326e-16, -4.026719478177421e-18, -1.208104541165525e-17, 
               -1.232595164407831e-32, 1.6653345369377348e-16, 5.273559366969494e-16, 5.9164567891575885e-31, 0.9595916641183336, 7.771561172376096e-16, -7.815231219132541e-17, -1.1102230246251565e-16, 1.4479766292312333e-16, -4.930380657631324e-32, -3.082993959262149e-15, -0.28139622981590806, -2.1891502079408748e-17, 1.4721756920982566e-16, -2.220446049250313e-16, 1.942890293094024e-16, -4.385537891983004e-16, 6.226838360755755e-16, 2.6688539618391286e-16, -1.9299389218690579e-16, -1.4319853786863285e-17, 
               0.30707861756670846, -4.833141365006719e-16, -2.220446049250313e-16, -0.8921384925587372, -4.930380657631324e-32, 3.554773692825159e-16, 2.465190328815662e-32, 1.1102230246251565e-16, -2.465190328815662e-32, 0.3313482046553794, -4.930380657631324e-32, -7.703719777548943e-34, 1.232595164407831e-32, -2.7369110631344083e-48, 1.086083148031523e-17, -1.3877787807814457e-17, 1.401298464324817e-45, -1.232595164407831e-32, 0.0, -1.0947644252537633e-47, -5.473822126268817e-48, 
               1.5407439555097887e-33, 0.0, 0.0, 0.0, 3.7306109722961417e-16, 0.0, 1.0802972428941864e-15, -1.249000902703301e-16, 2.853204463884451e-16, -1.232595164407831e-32, -0.9545870548474232, 8.477231419991162e-15, -4.343668103818067e-16, -9.3776729501399e-17, 2.0816681711721685e-16, 3.3306690738754696e-16, 1.1400950366848004e-15, -9.692727368117879e-16, -0.297932131059613, -5.221537399994928e-16, -1.2741848275669542e-16, 
               -3.851859888774472e-34, 3.469446951953614e-18, -8.326672684688674e-17, 0.0, 2.6955129957765943e-16, 1.1102230246251565e-16, -3.5487583980555746e-15, 6.38378239159465e-16, 0.959591664118334, 1.8488927466117464e-32, 9.761759192610338e-17, 1.426538772956802e-15, -4.585712771730766e-16, 8.926222776507293e-16, -1.6653345369377348e-16, 0.0, -1.0305878352626002e-14, -0.2813962298159071, 2.952265867507586e-16, -1.619443094195698e-17, 2.727513350243281e-17, 
               -7.197608495556836e-18, 2.0816681711721685e-16, 0.3070786175667097, -1.4404909752840438e-16, -3.030241054080013e-16, 1.536964999715451e-15, 6.938893903907228e-16, -0.8921384925587367, 6.648945738191186e-16, -2.5425538283087473e-17, 2.978933155596711e-16, 4.942382810100297e-17, -6.938893903907228e-17, -1.1324468072996947e-31, -1.5100767858378106e-15, 0.33134820465537945, -2.6938367318133145e-29, 3.120768070811279e-16, -9.988882624316109e-17, 1.59033665157776e-31, 1.0342243801359457e-31, 
               -6.695923377928597e-17, 0.2908927632433781, 6.38378239159465e-16, -5.053404539815799e-16, 6.661338147750939e-16, -0.8925826089613021, -2.3754719506754956e-16, -1.0477729794899915e-15, 1.4128452672824734e-16, 8.456415130551271e-17, 6.057939687629186e-17, 0.0, -7.159756319600435e-17, 4.930380657631324e-32, 0.34449627933036864, 1.4988010832439613e-15, -1.7256332301709633e-30, 7.337278083251453e-17, -4.6942876492757946e-17, 4.930380657631324e-32, -1.5407439555097887e-33, 
               8.756652314462969e-49, -2.8011886663647593e-33, 7.198912856894566e-32, 3.011954412072234e-47, 1.0645750793891447e-16, 1.3780466767797758e-31, -1.5304611950451075e-16, -1.913132981326305e-30, 8.298269910336292e-17, -1.0353438215516063e-47, 4.2828744570827193e-16, -7.865323542258916e-16, 1.2139950965339457e-15, -5.279046968716289e-15, 7.789272926315248e-31, 5.876170478653313e-31, 1.0000000000000002, -3.68616105357965e-14, 2.7817301004035528e-15, -1.132813805740147e-15, 7.008682406728511e-16, 
               5.345529420184391e-51, 0.0, 0.0, 0.0, 1.3877787807814457e-17, 1.9721522630525295e-31, -3.885780586188048e-16, -1.1832913578315177e-30, 6.938893903907228e-16, 0.0, 1.6653345369377348e-16, -4.996003610813204e-16, 1.4432899320127035e-15, -0.9999999999999999, 1.9721522630525295e-31, 7.888609052210118e-31, -5.278902811332381e-15, -1.0547118733938987e-15, -6.661338147750939e-16, -4.192589961148101e-16, 3.0031405435127363e-16, 
               2.3175106839715363e-33, -6.9332452057199794e-18, -7.108798410571972e-17, 8.099701845014824e-32, -6.111822709958361e-16, -6.041329684766433e-17, 0.2979321310596138, 2.441960088901568e-16, 6.87974397399427e-16, -3.313802605239631e-32, 7.917240889661559e-16, -1.1248740427744713e-15, -0.9545870548474232, -1.5889197241320105e-15, -1.4095510065696785e-16, -9.498650492533319e-17, 1.4966350666628424e-15, -6.186445266075065e-16, -6.382722486267536e-16, 7.724635048380488e-17, 1.5647230985626452e-17, 
               -2.700744107067746e-33, 2.2102753259754987e-17, 1.3976505437206692e-16, 2.002264499110177e-31, 0.28139622981590795, 2.8382621807164057e-16, -6.86963972153906e-16, -3.4342435679967655e-17, -1.6694523730363094e-15, -4.816581045941172e-32, 1.185810866629916e-14, 0.9595916641183336, -1.9439374584243023e-15, -4.4341388556974225e-16, 1.0308907049503439e-16, -8.074163516567135e-17, 7.720610050340764e-16, -2.0968952194618977e-15, -4.751778343338119e-16, 6.578196864489662e-16, 4.895628287079981e-17, 
               0.023503101972240495, -3.6981771356679976e-16, -1.1102230246251565e-16, -0.34095494826366346, -1.7256332301709633e-31, -7.572479248980558e-17, 7.395570986446986e-32, 4.163336342344337e-17, -1.8488927466117464e-32, -0.9397857880667302, -6.162975822039155e-32, -1.1555579666323415e-33, 1.5407439555097887e-32, -4.7895943604852146e-48, -9.814319085931444e-17, 2.0816681711721685e-17, 1.401298464324817e-45, -2.1570415377137042e-32, 1.925929944387236e-33, -1.9158377441940858e-47, -8.210733189403225e-48, 
               -2.922529388493279e-51, -2.0835899963514587e-34, -1.557560781705292e-32, 0.0, -9.992374079662345e-20, -4.507217712466116e-30, 4.7894849592892974e-17, -4.276256152193456e-28, -1.5306096646303538e-16, -9.481993295828409e-49, 2.274896791883764e-16, 1.4478954232599288e-16, -1.7424242308809623e-17, -1.6198910336388883e-16, 9.148034893549821e-30, 5.842531844840235e-29, 7.808485410946179e-16, 2.0556709353945302e-17, -1.6390740450910703e-16, -5.351185572990913e-16, -1.0, 
               -2.215670250134761e-50, 0.0, -9.51646834893206e-33, 0.0, 2.7514216074017515e-19, -1.2198770535997446e-31, 9.65966204439092e-18, -9.28205972589791e-30, 3.1041578892435795e-17, 0.0, 3.975635588462561e-16, 5.493031345784075e-16, -5.187757315834848e-17, 8.068641646600116e-16, 2.9999246700481876e-31, 1.8176888843312455e-30, -1.2777733119718208e-15, 1.2228117391523433e-16, 2.8202595311186826e-17, -1.0, 6.788179754174705e-16, 
               -3.1429923512581115e-36, 4.2226448090225955e-19, 3.508365966895076e-18, 0.0, -6.806298773255413e-17, -5.189177025486334e-18, 7.05687895831048e-16, -3.489127531897554e-17, -7.895255075100298e-17, 1.9216395663220067e-33, -0.29793213105961297, 3.053924800266142e-15, -6.303695041623751e-16, -7.546501505859617e-16, 1.7778289803706903e-16, 4.4376779406643505e-16, -2.3368053202734964e-15, 2.0881737519283593e-16, 0.9545870548474236, -1.3274579518567124e-16, -2.1047828202722228e-16, 
               -3.414735609180732e-35, 0.0, -8.561252852388326e-18, 0.0, 1.6653345369377348e-16, 1.9984417135368916e-17, -2.544622498823479e-16, 1.461006736662723e-16, 0.2813962298159073, 0.0, -7.7021722333370235e-16, 2.581268532253489e-15, -1.8214596497756474e-16, -8.119545006945811e-16, -2.6802887007751884e-16, -1.0891017683765197e-15, 3.5245044073430824e-14, 0.959591664118334, -3.7816971776294395e-16, 1.2788494287297099e-16, 3.679311980245697e-17, 
               2.85615806271311e-19, 6.591949208711867e-17, 0.023503101972240877, -1.3085361393702684e-17, 1.2876361075162937e-16, 2.177077962350893e-16, 3.8163916471489756e-16, -0.34095494826366335, -2.7567103011739383e-17, -3.6488382737705796e-17, -2.4429021075133187e-16, -1.367487703680596e-16, 1.3183898417423734e-16, -1.1137652868391385e-30, 4.194778205346417e-15, -0.9397857880667301, -7.566593565508572e-30, -1.01479960523962e-15, 3.566093728695615e-16, -2.3585419581452187e-31, 5.92223457899075e-32, 
               -3.5908029009797335e-18, 0.026978011070944385, 6.453171330633722e-16, -1.026281907598009e-16, 8.326672684688674e-17, -0.3522717215205378, 2.898356050468326e-17, -2.5673907444456745e-16, -1.0558164675743698e-16, 1.6564602857981286e-16, -2.3843674773438485e-16, 1.8041124150158794e-16, 1.6573513363576313e-16, -8.258387601532467e-31, -0.9355088567916461, -3.649858193455202e-15, 1.3435287292045357e-30, -2.249650788525882e-16, 1.118834404771356e-16, -1.232595164407831e-32, 1.8103741477240017e-32
             };
       static constexpr double m_epsDW3D[20] = {
                   1.311298227473547,
                   1.7365345530210368,
                   2.311298227473547,
                   2.311298227473547,
                   2.714038230109307,
                   2.871620832904488,
                   2.871620832904489,
                   3.435810416452241,
                   3.4358104164522443,
                   3.4358104164522443,
                   3.4425175292401833,
                   3.714038230109307,
                   3.7140382301093076,
                   3.871620832904486,
                   3.8716208329044877,
                   3.871620832904489,
                   4.435810416452242,
                   4.435810416452242,
                   4.4358104164522425,
                   4.435810416452244
             };
       static constexpr double m_C3D[400] = {
               0.9545870548474235, 0.0, 0.0, 0.0, 0.29793213105961275, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
               0.0, 0.0, 0.0, -0.9545870548474235, 0.0, 0.0, -3.885780586188048e-16, 0.0, 0.0, 0.0, 0.0, 0.2979321310596122, 0.0, 9.30802620673096e-32, 1.0311971101797015e-31, 4.127794097917629e-31, -4.054786417082123e-16, 2.223567591135313e-16, 4.894082342054236e-16, 2.2327037983135027e-16, 
               0.0, 0.0, 0.9545870548474235, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2979321310596126, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
               0.0, 0.9595916641183337, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.28139622981590756, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
               0.0, -2.220446049250313e-16, 0.0, 7.129556204034456e-47, 0.0, -5.811646284617332e-32, -2.0601749674541454e-31, -0.6463748961301955, 9.640305281498856e-16, -0.7630199824727257, -9.43689570931383e-16, -5.644231994860612e-47, 0.0, 2.50590186093131e-63, 9.837842052072376e-63, 2.0864639667948037e-62, 8.297795278270594e-47, 1.2327923226338315e-47, 3.097029290714301e-47, -1.318016214680273e-46, 
               0.0, 0.0, 0.0, 7.395570986446983e-32, 0.0, -6.028487807093333e-17, -2.137043285763906e-16, 7.925496030572804e-16, 1.0, 5.920504982474108e-16, 0.0, -5.854827030937196e-32, 0.0, 2.5994009398649424e-48, 1.0204907173378235e-47, 2.164313168379668e-47, 8.607398869613877e-32, 1.2787897132259275e-32, 3.2125842494406786e-32, -1.36719344065767e-31, 
               0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.7630199824727254, 2.2204460492503123e-16, 0.6463748961301957, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
               0.0, 0.0, 0.0, 3.3306690738754696e-16, 0.0, -0.2714989544163312, -0.962438734544095, 0.0, -2.2204460492503126e-16, 0.0, 0.0, -2.636779683484747e-16, 0.0, 1.1706661104162274e-32, 4.595881614337673e-32, 9.747199978627732e-32, 3.8764278341822297e-16, 5.759156875969512e-17, 1.4468193228677367e-16, -6.15729186988927e-16, 
               0.0, 0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.962438734544095, -0.2714989544163312, 0.0, 0.0, 0.0, 0.0, -5.551115123125783e-17, 0.0, 3.3023881265460164e-33, 1.2964742670139797e-32, 2.749634348349339e-32, 1.0935201027101008e-16, 1.6246281597197206e-17, 4.08140195618798e-17, -1.736939967927406e-16, 
               0.29793213105961275, 0.0, 0.0, 0.0, -0.9545870548474235, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
               0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 5.551115123125783e-16, 0.0, 0.0, 0.0, 0.0, 5.967448757360216e-16, 0.0, -7.733785978727359e-17, 9.153978695754095e-17, -8.335902890522959e-17, 0.5628560012155174, -0.058055501618703306, 0.06345152538532885, -0.8220684792362213, 
               0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, -2.7755575615628914e-17, 0.0, 0.0, 0.0, 0.0, -6.661338147750939e-16, 0.0, -1.115889655870176e-15, 1.0574690815409593e-15, -1.5242080993964273e-15, -0.09262397015945041, -0.9268727838016159, 0.3625277948345387, 0.030020672413365406, 
               0.0, 0.0, 0.0, 1.6653345369377348e-16, 0.0, 0.0, 8.326672684688674e-17, 0.0, 0.0, 0.0, 0.0, -8.881784197001252e-16, 0.0, 2.5320348295429357e-16, 2.1005255820887622e-16, 8.951435497367665e-16, -0.30845169397544864, 0.3627488706834894, 0.8627259666875402, -0.17021961022331725, 
               0.0, 0.0, 0.0, -2.3665827156630354e-30, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.553642593724587e-17, 8.459483297358266e-17, 1.6457240410845148e-16, 0.7612302375308373, 0.0771340274943314, 0.3467728482764052, 0.5425195470851882, 
               0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4695551898961461, 0.31000036688076593, 0.8266908105061921, 0.0, -6.106226635438361e-16, -4.440892098500626e-16, 0.0, 
               0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.6893057093850469, -0.4563723300125947, 0.5626561431354434, 0.0, -1.9984014443252818e-15, 1.1102230246251565e-16, 0.0, 
               0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5517024221904154, 0.8340408077142664, 0.0006069732800393357, 0.0, 0.0, -5.551115123125783e-16, 0.0, 
               0.0, 0.0, 0.0, -0.2979321310596122, 0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, -0.9545870548474236, 0.0, 7.888609052210118e-31, -8.874685183736383e-31, 5.9164567891575885e-31, 6.522560269672795e-16, 4.440892098500626e-16, -1.1379786002407855e-15, -2.463307335887066e-16, 
               0.0, 0.0, 0.2979321310596126, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.9545870548474235, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
               0.0, 0.2813962298159076, 0.0, 0.0, 0.0, 0.0, 0.0, -6.231251324992198e-16, 0.0, -7.355745566920983e-16, 0.9595916641183336, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0
             };


   public:
       DWC(const unsigned int dim) {
           if (dim==2) {
               C = Eigen::Map<const Eigen::MatrixXd>(m_C2D,21,21);
               epsDW = Eigen::Map<const Eigen::ArrayXd>(m_epsDW2D,21);
           } else if (dim==3) {
               C = Eigen::Map<const Eigen::MatrixXd>(m_C3D,20,20);
               epsDW = Eigen::Map<const Eigen::ArrayXd>(m_epsDW3D,20);
           } // end ifeif

       } // end constructor
       virtual ~DWC() {}

       Eigen::MatrixXd C;
       Eigen::ArrayXd epsDW;
};

#endif
