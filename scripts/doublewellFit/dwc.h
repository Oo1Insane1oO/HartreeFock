#ifndef DWC_H
#define DWC_H

#include <array>

class DWC {
   private:
       static constexpr std::array<double,15> m_epsDW2D = {
                   0.8098899984127204,
                   1.236534553021035,
                   1.8112982274735465,
                   2.0042031506581153,
                   2.2365345530210368,
                   2.811298227473548,
                   2.9425175292401824,
                   3.21403823010931,
                   3.371620832904485,
                   3.8071034640383443,
                   3.935810416452247,
                   3.942517529240183,
                   4.214038230109306,
                   4.371620832904488,
                   4.935810416452241
             };
       static constexpr std::array<double,225> m_C2D = {
               0.9513938862695098, 0.0, 0.0, 0.2963758312507063, 0.0, 0.0, 0.0, 0.0, 0.0, -0.08373195220136545, 0.0, 0.0, 0.0, 0.0, 0.0, 
               -5.551115123125783e-17, 2.8904644780293576e-15, 0.9545870548474233, 1.1102230246251565e-16, 2.855748374323253e-16, 2.441256023748184e-16, 1.4718989335014478e-15, -0.29793213105961275, 4.468377096088191e-31, 1.1102230246251565e-16, 1.1479571917625448e-16, -3.9089032584651866e-19, -3.0792046480667124e-17, -1.8485438165758764e-31, -9.156597109055217e-32, 
               0.0, 0.9595916641183341, -3.497202527569243e-15, 0.0, -1.967655333077985e-16, -4.508268498574143e-17, 0.28139622981590645, -8.326672684688674e-17, 5.201539261773937e-32, 0.0, 2.957764884138563e-17, -4.309735189569704e-18, 1.0666677794707567e-16, -4.29390920107251e-32, 5.054272431675458e-32, 
               0.0, -4.440892098500626e-16, -2.220446049250313e-16, 0.0, 7.596782415827785e-17, 0.9545870548474232, 1.3877787807814457e-15, 5.898059818321144e-16, 3.1495574293670405e-16, 0.0, -2.6724382602780853e-16, 2.0047064708434432e-16, 0.2979321310596127, -1.0733329710226123e-17, -2.2288027759076385e-16, 
               0.0, -1.1102230246251565e-16, 2.220446049250313e-16, 0.0, -0.9595916641183337, -1.4314425995351935e-16, -3.3306690738754696e-16, -2.7755575615628914e-17, -3.000724768560533e-17, 0.0, -9.077489820864257e-15, 0.2813962298159066, -1.2848980205655139e-17, 1.4301439384828374e-16, 1.785843428442153e-17, 
               0.3070786175667093, 5.702203270452197e-17, 1.1102230246251565e-16, -0.8921384925587371, 4.930380657631324e-32, 0.0, 2.6375972074135592e-17, -5.551115123125783e-17, 8.758115402030107e-47, 0.3313482046553793, 2.465190328815662e-32, -2.8888949165808538e-34, -6.162975822039155e-33, -2.1895288505075267e-47, -2.1895288505075267e-47, 
               0.0, -3.469446951953614e-18, 1.3877787807814457e-17, 0.0, 3.073363816082123e-17, 1.5090986465243392e-16, -1.1102230246251565e-16, 4.440892098500626e-16, 1.915505661114756e-16, 0.0, 0.9999999999999998, 4.725354993034247e-14, 4.1683351530557264e-16, -2.0620425782464445e-15, -1.7072676182048873e-16, 
               0.0, 0.0, 0.0, 0.0, -2.42861286636753e-17, -2.2854981795994433e-16, 0.0, 0.0, 0.9999999999999997, 0.0, -2.0816681711721685e-16, -2.7755575615628914e-16, -1.1102230246251565e-16, -1.7524077070575544e-15, -6.391715779826994e-16, 
               0.0, 1.1379786002407855e-15, 0.29793213105961275, 0.0, -1.732718015310938e-17, -4.718447854656915e-16, -7.216449660063518e-16, 0.9545870548474232, -1.3805065841367707e-30, 0.0, -3.9834331522614273e-16, -3.447183835563791e-17, 1.249000902703301e-16, 6.0551237451534695e-31, 1.5407439555097887e-31, 
               0.0, 0.2813962298159066, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 1.4767757144916948e-15, -0.959591664118334, -8.604228440844963e-16, 2.0029671421627253e-31, 0.0, -9.164099316518198e-17, 5.551115123125783e-17, -7.142019210678967e-17, 1.4791141972893971e-31, -4.807121141190541e-31, 
               0.0, -1.4294474631675512e-32, 6.37841248179403e-32, 0.0, -1.5778405916859308e-17, -8.62565704668759e-17, 6.917405458238086e-29, -1.0141743134362586e-28, -4.480034628007112e-16, 0.0, -1.798053053563472e-16, 3.648663143220157e-18, -8.747467518036438e-17, -1.8312917278349916e-16, -0.9999999999999999, 
               0.0, -2.82118644197349e-37, 0.0, 0.0, 3.2526065174565133e-19, 1.734723475976807e-17, 0.0, 0.0, 1.3438147432327662e-15, 0.0, 1.9984014443252818e-15, -4.996003610813204e-16, -1.0842021724855044e-19, 1.0, -2.5658541189390804e-16, 
               0.0, -4.808969201719732e-17, -3.991624071356241e-17, 0.0, 1.1261248765212383e-16, 0.2979321310596128, 5.119522130012121e-16, 2.645088558454989e-16, 3.5925307576129234e-30, 0.0, 3.547267995816635e-16, 3.959651945946503e-16, -0.9545870548474235, -4.0671077432729896e-18, 2.2391484609148473e-17, 
               0.0, -2.498569729954593e-17, 6.737147723387662e-17, 0.0, -0.2813962298159065, 3.347745258092111e-16, -1.4895847406306373e-16, -3.6733051654028474e-17, -2.7755575615628943e-16, 0.0, 3.118330756854872e-14, -0.959591664118334, -2.7755575615625896e-16, -4.880321730084742e-16, 4.252540779953801e-18, 
               0.023503101972240828, 1.9753011559017116e-16, 1.6653345369377348e-16, -0.34095494826366324, 3.697785493223493e-32, 3.697785493223493e-32, 9.136904746284107e-17, -4.163336342344337e-17, 6.56858655152258e-47, -0.9397857880667302, 1.8488927466117464e-32, -7.462978534500539e-34, 1.8488927466117464e-32, -3.28429327576129e-47, -5.473822126268817e-48
             };
       static constexpr std::array<double,10> m_epsDW3D = {
                   1.311298227473547,
                   1.8716208329044879,
                   2.435810416452244,
                   2.435810416452244,
                   2.714038230109307,
                   2.8716208329044877,
                   2.8716208329044877,
                   3.435810416452244,
                   3.435810416452244,
                   3.435810416452244
             };
       static constexpr std::array<double,100> m_C3D = {
               0.9545870548474235, 0.0, 0.0, 0.0, 0.29793213105961275, 0.0, 0.0, 0.0, 0.0, 0.0, 
               0.0, 0.0, 0.0, -1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
               0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
               0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
               0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 
               0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 
               0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 
               0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 
               0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 
               0.29793213105961275, 0.0, 0.0, 0.0, -0.9545870548474235, 0.0, 0.0, 0.0, 0.0, 0.0
             };


   public:
       DWC(const unsigned int dim) {
           if (dim==2) {
               C = Eigen::Map<const Eigen::MatrixXd>(m_C2D.data(),15,15);
               epsDW = Eigen::Map<const Eigen::ArrayXd>(m_epsDW2D.data(),15);
           } else if (dim==3) {
               C = Eigen::Map<const Eigen::MatrixXd>(m_C3D.data(),10,10);
               epsDW = Eigen::Map<const Eigen::ArrayXd>(m_epsDW3D.data(),10);
           } // end ifeif

       } // end constructor
       virtual ~DWC() {}

       Eigen::MatrixXd C;
       Eigen::ArrayXd epsDW;
};

#endif
